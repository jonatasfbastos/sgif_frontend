<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tela Login</title>
    <link rel="stylesheet" href="index.css" />
    <script type="text/javascript" src="../js/session.js"></script>
  </head>
  <body>
    <main>
      <!-- =========={header-section}========== -->
      <div class="header-section">
        <div class="content-header">
          <div class="salmos">
            <h1>SGIF</h1>
            <p class="version">1.0</p>
          </div>
          <div class="contanier-img">
            <img
              src="../images/crescimento.png"
              alt="armazém"
              class="icon-armazem"
            />
          </div>
          <div class="system-type">
            <h2>Sistema Gerenciador do IF</h2>
          </div>
        </div>
      </div>
      <!-- =========={END header-section}========== -->

      <!-- =========={login-container}========== -->
      <div class="login-container">
        <div class="form-container">
          <img src="../images/enter.png" alt="enter" />
          <h2>Bem vindo</h2>
          <span>Entre com a sua conta</span>

          <form>
            <input
              id="usuario"
              type="text"
              name="username"
              placeholder="E-mail/Login"
              class="user"
              autocomplete="off"
              autofocus
              onkeyup="handleChangeField()"
              required
            />
            <input
              id="senha"
              type="password"
              name="password"
              placeholder="Senha"
              class="keyword"
              autocomplete="off"
              onkeyup="handleChangeField()"
              required
            />
            <input
              id="botao-login"
              type="submit"
              name="send"
              value="Logar"
              class="button"
              onclick="getDatas(event)"
            />
            <p class="forgot">Esqueceu a senha?</p>
          </form>
        </div>
      </div>
      <!-- =========={END login-container}========== -->
    </main>

    <script src="../js/requisitions.js"></script>

    <script>
      function getDatas(e) {
        e.preventDefault();
        var usuario = document.getElementById("usuario").value;
        var senha = document.getElementById("senha").value;

        const user = {
          login: usuario,
          senha: senha,
        };

        post("login", user)
          .then((usuario) => {
            if (!usuario) return;

            setUser(usuario);
            window.location.replace(
              "../br.com.ifba.homescreensad/homescreensad.html"
            );
          })
          .catch((erro) => {
            console.log(erro);
            showMessage({
              type: "warning",
              message: "Verifique o login e a senha e tente novamente",
            });
          });
      }

      function handleChangeField() {
        var usuario = document.getElementById("usuario");
        var senha = document.getElementById("senha");
        var botaoLogin = document.getElementById("botao-login");

        usuario.addEventListener("keyup", function (e) {
          var key = e.which || e.keyCode;
          if (key == 13) {
            // codigo da tecla enter
            // colocas aqui a tua função a rodar
            if (senha.value === "" || senha.value === null) {
              senha.focus();
            } else {
              botaoLogin.click();
            }
          }
        });

        senha.addEventListener("keyup", function (e) {
          var key = e.which || e.keyCode;
          if (key == 13) {
            // codigo da tecla enter
            // colocas aqui a tua função a rodar
            if (senha.value === "" || senha.value === null) {
              senha.focus();
            } else if (usuario.value === "" || usuario.value === null) {
              usuario.focus();
            } else {
              botaoLogin.click();
            }
          }
        });
      }
    </script>
  </body>
</html>
